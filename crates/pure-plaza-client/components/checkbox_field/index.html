<!doctype html>
<html lang="pl">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>Przykład użycia mountCheckbox (Tailwind + Pure JS)</title>
		<script src="https://cdn.tailwindcss.com"></script>
	</head>
	<body class="bg-neutral-950 text-neutral-100 min-h-screen p-8">
		<header class="mb-8">
			<h1 class="text-2xl font-semibold">Przykład komponentu Checkbox (Switch)</h1>
			<p class="text-neutral-400">
				Pure JS + TailwindCSS. Dwie instancje: podstawowa oraz integracja z TextField.
			</p>
		</header>

		<main class="flex flex-col lg:flex-row gap-10">
			<!-- Instancja 1: Podstawy i API -->
			<section class="space-y-4 w-full">
				<h2 class="text-lg font-medium">Instancja 1</h2>
				<div id="chk1"></div>
				<div id="status1" class="text-xs text-neutral-400">Stan: Nie</div>

				<div class="flex flex-wrap gap-3">
					<button id="show1" class="px-4 py-2 rounded-lg bg-yellow-600 hover:bg-yellow-500 text-black">Pokaż stan</button>
					<button id="toggle1" class="px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700">Przełącz programowo</button>
					<button id="labels1" class="px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700">Zmień etykiety stanu</button>
					<button id="error1" class="px-4 py-2 rounded-lg bg-red-600/80 hover:bg-red-600 text-white">Pokaż błąd</button>
					<button id="clearError1" class="px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700">Wyczyść błąd</button>
					<button id="disable1" class="px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700">Wyłącz</button>
					<button id="enable1" class="px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700">Włącz</button>
				</div>
			</section>

			<!-- Instancja 2: Integracja z TextField -->
			<section class="space-y-4 w-full">
				<h2 class="text-lg font-medium">Instancja 2 (Integracja z TextField)</h2>

				<div class="rounded-xl ring-1 ring-inset ring-neutral-800 bg-neutral-950/60 p-4">
					<div class="flex items-start justify-between gap-6">
						<div class="flex-1">
							<p class="text-sm font-medium">Czy kandydat pracował wcześniej w firmie?</p>
							<p class="text-xs text-neutral-500 mt-1">Włącz, aby dodać numer z poprzedniego zatrudnienia.</p>
						</div>
						<div id="chk2"></div>
					</div>

					<div class="mt-4" id="empIdField"></div>

					<div class="mt-4 flex gap-3">
						<button id="save2" class="px-4 py-2 rounded-lg bg-blue-600/80 hover:bg-blue-600 text-white">Zapisz (walidacja)</button>
						<button id="clear2" class="px-4 py-2 rounded-lg bg-neutral-800 hover:bg-neutral-700">Wyczyść</button>
					</div>
				</div>
			</section>
		</main>

		<!-- mountTextField będzie dostępny z tego pliku -->
		<script src="/main.js"></script>
		<!-- Załaduj implementację mountCheckbox (umieść w tym pliku funkcję mountCheckbox z projektu) -->
		<script src="/components/checkbox_field/main.js"></script>
		<script src="/components/text_field/main.js"></script>

		<script>
		// Instancja 1
		const api1 = mountCheckbox('#chk1', {
			label: 'Powiadomienia e-mail',
			trueLabel: 'Włączone',
			falseLabel: 'Wyłączone',
			checked: false,
			clearErrorOnChange: true,
			onChange: ({ checked }) => {
				document.getElementById('status1').textContent = 'Stan: ' + (checked ? 'Włączone' : 'Wyłączone');
			},
		});

		document.getElementById('show1').addEventListener('click', () => {
			alert('Aktualny stan: ' + (api1.getChecked() ? 'Włączone' : 'Wyłączone'));
		});
		document.getElementById('toggle1').addEventListener('click', () => {
			api1.toggle();
		});
		document.getElementById('labels1').addEventListener('click', () => {
			api1.setStateLabels({ trueLabel: 'Tak', falseLabel: 'Nie' });
		});
		document.getElementById('error1').addEventListener('click', () => {
			api1.setError('Wystąpił błąd dla tego przełącznika');
		});
		document.getElementById('clearError1').addEventListener('click', () => {
			api1.clearError();
		});
		document.getElementById('disable1').addEventListener('click', () => {
			api1.disable();
		});
		document.getElementById('enable1').addEventListener('click', () => {
			api1.enable();
		});

		// Instancja 2 – z TextField
		const prevEmployment = mountCheckbox('#chk2', {
			label: 'Pracował wcześniej?',
			trueLabel: 'Tak',
			falseLabel: 'Nie',
			checked: false,
			clearErrorOnChange: true,
		});

		const empId = mountTextField('#empIdField', {
			type: 'text',
			label: 'Numer pracownika z poprzedniego zatrudnienia',
			placeholder: 'np. 12345',
			value: '',
			disabled: true,
			clearErrorOnInput: true,
		});

		// Zależność: gdy checkbox włączony, odblokuj pole; gdy wyłączony – zablokuj i wyczyść
		prevEmployment.setOnChange(({ checked }) => {
			if (checked) {
				empId.enable();
			} else {
				empId.disable();
				empId.clear({ silent: true });
				empId.clearError();
			}
		});

		// Walidacja i zapisz
		document.getElementById('save2').addEventListener('click', () => {
			// wyczyść poprzedni błąd
			empId.clearError();

			const payload = {
				workedBefore: prevEmployment.getChecked(),
				employeeId: empId.getValue().trim(),
			};

			if (payload.workedBefore && payload.employeeId.length === 0) {
				empId.setError('Podaj numer pracownika, jeśli pracował wcześniej.');
				return;
			}

			alert('Dane do zapisu:\n' + JSON.stringify(payload, null, 2));
		});

		// Wyczyść instancję 2 do stanu początkowego
		document.getElementById('clear2').addEventListener('click', () => {
			prevEmployment.setChecked(false, { silent: true });
			empId.clear({ silent: true });
			empId.disable();
			empId.clearError();
		});
		</script>
	</body>
</html>
