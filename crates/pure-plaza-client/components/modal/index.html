<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<title>mountModal — Pure JS + TailwindCSS Demo</title>
		<link rel="stylesheet" href="/tailwind.css">
	</head>
	<body class="bg-neutral-950 text-neutral-100 min-h-screen p-8">
		<header class="mb-8">
			<h1 class="text-2xl font-semibold">Modal Component Demo (mountModal)</h1>
			<p class="text-neutral-400">Pure JS + TailwindCSS. Two independent modal instances with live controls.</p>
		</header>

		<main class="flex flex-col lg:flex-row gap-10">
			<!-- Instance 1 -->
			<section class="space-y-4 w-full">
				<h2 class="text-lg font-medium">Instance 1 — Confirm dialog</h2>

				<!-- Mount point -->
				<div id="modal1-root"></div>

				<!-- Live meta -->
				<div class="text-sm text-neutral-400 space-y-1">
					<div>Open: <span id="meta1-open" class="text-neutral-200">no</span></div>
					<div>Size: <span id="meta1-size" class="text-neutral-200">md</span></div>
					<div>closeOnEsc: <span id="meta1-esc" class="text-neutral-200">yes</span> | closeOnBackdrop: <span id="meta1-backdrop" class="text-neutral-200">yes</span></div>
				</div>

				<!-- Controls -->
				<div class="flex flex-wrap gap-3">
					<button id="open1" class="px-4 py-2 rounded-md bg-yellow-400 text-black font-semibold hover:bg-yellow-300">Open</button>
					<button id="close1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Close</button>

					<button id="title1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Set title</button>
					<button id="content1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Set content (HTML)</button>

					<button id="sizeSm1" class="px-3 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700 text-sm">Size: sm</button>
					<button id="sizeMd1" class="px-3 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700 text-sm">Size: md</button>
					<button id="sizeLg1" class="px-3 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700 text-sm">Size: lg</button>
					<button id="sizeXl1" class="px-3 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700 text-sm">Size: xl</button>

					<button id="toggleEsc1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Toggle closeOnEsc</button>
					<button id="toggleBackdrop1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Toggle closeOnBackdrop</button>

					<button id="actionsDefault1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Default actions</button>
					<button id="actionsNone1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">No actions</button>

					<button id="destroy1" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Destroy</button>
				</div>
			</section>

			<!-- Instance 2 -->
			<section class="space-y-4 w-full">
				<h2 class="text-lg font-medium">Instance 2 — Long content + focus trap</h2>

				<!-- Mount point -->
				<div id="modal2-root"></div>

				<div class="text-sm text-neutral-400">
					<div>Open: <span id="meta2-open" class="text-neutral-200">no</span></div>
				</div>

				<div class="flex flex-wrap gap-3">
					<button id="open2" class="px-4 py-2 rounded-md bg-yellow-400 text-black font-semibold hover:bg-yellow-300">Open long modal</button>
					<button id="close2" class="px-4 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700">Close</button>
					<button id="sizeLg2" class="px-3 py-2 rounded-md bg-neutral-800 hover:bg-neutral-700 text-sm">Size: lg</button>
				</div>
			</section>
		</main>

		<script src="../../main.js"></script>
		<script src="./main.js"></script>
		<!-- Demo logic -->
		<script>
		// Instance 1
		const modal1 = mountModal('#modal1-root', {
			title: 'Delete resource',
			contentHtml: `
<div class="space-y-3">
<p class="text-neutral-300">Are you sure you want to delete this item? This action cannot be undone.</p>
<label class="inline-flex items-center gap-2 text-sm">
<input type="checkbox" class="rounded bg-neutral-950/60 ring-1 ring-neutral-800 focus:ring-2 focus:ring-blue-400/60">
<span>Also remove related data</span>
</label>
</div>
`,
			size: 'md',
			primaryAction: {
				label: 'Delete',
				onClick: (e, api) => {
					alert('Deleted!');
					api.close();
				},
			},
			secondaryAction: {
				label: 'Cancel',
				onClick: (e, api) => api.close(),
			},
			onOpen: () => refreshMeta1(),
			onClose: () => refreshMeta1(),
		});

		// Instance 2
		const longContent = `
<div class="space-y-4 max-h-[50vh] overflow-auto pr-2">
<p class="text-neutral-300">This modal contains a lot of content to demonstrate scrolling and focus trap.</p>
<div class="space-y-3">
<input type="text" placeholder="Your name" class="w-full rounded-md bg-neutral-950/60 text-neutral-100 placeholder-neutral-500 px-3.5 py-2.5 transition hover:bg-neutral-900/60 focus:outline-none focus:bg-neutral-950/80 ring-1 ring-inset ring-neutral-800 focus:ring-2 focus:ring-blue-400/60" />
<input type="email" placeholder="you@example.com" class="w-full rounded-md bg-neutral-950/60 text-neutral-100 placeholder-neutral-500 px-3.5 py-2.5 transition hover:bg-neutral-900/60 focus:outline-none focus:bg-neutral-950/80 ring-1 ring-inset ring-neutral-800 focus:ring-2 focus:ring-blue-400/60" />
<textarea rows="4" placeholder="Message..." class="w-full rounded-md bg-neutral-950/60 text-neutral-100 placeholder-neutral-500 px-3.5 py-2.5 transition hover:bg-neutral-900/60 focus:outline-none focus:bg-neutral-950/80 ring-1 ring-inset ring-neutral-800 focus:ring-2 focus:ring-blue-400/60"></textarea>
<a href="#" class="inline-block text-blue-400 hover:underline">A focusable link</a>
</div>
<div class="space-y-2">
${Array.from({length: 10}).map((_,i)=>`<p class="text-neutral-400">Paragraph ${i+1}: Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>`).join('')}
</div>
</div>
`;
		const modal2 = mountModal('#modal2-root', {
			title: 'Feedback form',
			contentHtml: longContent,
			size: 'lg',
			primaryAction: {
				label: 'Send',
				onClick: (e, api) => {
					alert('Submitted!');
					api.close();
				},
			},
			secondaryAction: { label: 'Cancel', onClick: (e, api) => api.close() },
			onOpen: () => refreshMeta2(),
			onClose: () => refreshMeta2(),
		});

		// Helpers: meta refresh
		function refreshMeta1() {
			document.getElementById('meta1-open').textContent = modal1.isOpen() ? 'yes' : 'no';
		}
		function refreshMeta2() {
			document.getElementById('meta2-open').textContent = modal2.isOpen() ? 'yes' : 'no';
		}
		function setSizeMeta1(sz) {
			document.getElementById('meta1-size').textContent = sz;
		}
		function setEscMeta1(val) {
			document.getElementById('meta1-esc').textContent = val ? 'yes' : 'no';
		}
		function setBackdropMeta1(val) {
			document.getElementById('meta1-backdrop').textContent = val ? 'yes' : 'no';
		}

		// Bind controls — Instance 1
		document.getElementById('open1').addEventListener('click', () => { modal1.open(); refreshMeta1(); });
		document.getElementById('close1').addEventListener('click', () => { modal1.close(); refreshMeta1(); });

		document.getElementById('title1').addEventListener('click', () => {
			const next = prompt('New title:', 'Please confirm');
			if (next !== null) modal1.setTitle(next);
		});
		document.getElementById('content1').addEventListener('click', () => {
			modal1.setContent(`
<div class="space-y-3">
<p class="text-neutral-300">Updated content with <strong>HTML</strong>.</p>
<button class="inline-flex items-center gap-2 font-semibold ring-1 ring-inset ring-neutral-800 transition-colors focus:outline-none focus:ring-2 select-none rounded-md text-sm bg-transparent text-neutral-200 hover:bg-neutral-900/60 focus:ring-neutral-400/60 px-3 py-1.5"
onclick="alert('Inner button clicked!')">Inner button</button>
</div>
`);
		});

		document.getElementById('sizeSm1').addEventListener('click', () => { modal1.setSize('sm'); setSizeMeta1('sm'); });
		document.getElementById('sizeMd1').addEventListener('click', () => { modal1.setSize('md'); setSizeMeta1('md'); });
		document.getElementById('sizeLg1').addEventListener('click', () => { modal1.setSize('lg'); setSizeMeta1('lg'); });
		document.getElementById('sizeXl1').addEventListener('click', () => { modal1.setSize('xl'); setSizeMeta1('xl'); });

		let escEnabled1 = true;
		let backdropEnabled1 = true;
		document.getElementById('toggleEsc1').addEventListener('click', () => {
			escEnabled1 = !escEnabled1;
			modal1.setCloseOnEsc(escEnabled1);
			setEscMeta1(escEnabled1);
		});
		document.getElementById('toggleBackdrop1').addEventListener('click', () => {
			backdropEnabled1 = !backdropEnabled1;
			modal1.setCloseOnBackdrop(backdropEnabled1);
			setBackdropMeta1(backdropEnabled1);
		});
		document.getElementById('actionsDefault1').addEventListener('click', () => {
			modal1.setSecondaryAction({ label: 'Cancel', onClick: (e, api) => api.close() });
			modal1.setPrimaryAction({ label: 'Delete', onClick: (e, api) => { alert('Deleted!'); api.close(); } });
		});
		document.getElementById('actionsNone1').addEventListener('click', () => {
			modal1.setSecondaryAction(null);
			modal1.setPrimaryAction(null);
		});

		document.getElementById('destroy1').addEventListener('click', () => {
			modal1.destroy();
			alert('Instance 1 destroyed. Reload the page to restore it.');
		});

		// Instance 2 controls
		document.getElementById('open2').addEventListener('click', () => { modal2.open(); refreshMeta2(); });
		document.getElementById('close2').addEventListener('click', () => { modal2.close(); refreshMeta2(); });
		document.getElementById('sizeLg2').addEventListener('click', () => { modal2.setSize('lg'); });
		</script>
	</body>
</html>
