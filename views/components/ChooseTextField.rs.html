@use "components/TextField.rs.html"

@{
	let identifier = format!("{}", rand::random::<u32>());
}

<div class="w-full relative">
	<div class="flex flex-row flex-wrap gap-4" id="choose_text_field_chosen_elements_@identifier">

	</div>

	<TextField id={ chosen_text_field_text_field_@identifier } name=@name additional_classes={} disable_autocomplete=true additional_input_classes={}>
		@child_content
	</TextField>

	<div class="absolute top-[100%] left-0 flex flex-col w-full h-30 overflow-auto rounded-xl" id="choose_text_field_possible_elements_@identifier">
		@for item in items {
			<div class="w-full px-4 py-2 bg-neutral-900 hover:bg-neutral-800 cursor-pointer" data-value="@item.value">
				@item.display_text
			</div>
		}
	</div>
</div>

<script>
window.addEventListener("DOMContentLoaded", () => {
	const possibleItems = @#json(items)

	console.log(possibleItems);

	const textFieldId = "chosen_text_field_text_field_@identifier";
	const chosenElementsId = "choose_text_field_chosen_elements_@identifier";
	const possibleElementsId = "choose_text_field_possible_elements_@identifier";

	document.querySelector("body").addEventListener("click", (event) => {
		const possibleElementsElement = document.querySelector(`#${possibleElementsId}`);

		if (! possibleElementsElement.contains(event.target)) return;

		const eventElementValue = event.target.getAttribute('data-value');

		if (eventElementValue === undefined || eventElementValue === null) {
			return;
		}
	});
});
</script>
