<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<title>Confilogi IT Support - Forgot your password?</title>
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<link rel="stylesheet" href="/tailwind.css">
	</head>
	<body class="bg-neutral-950 text-neutral-200 min-h-screen flex flex-col">
		<!-- Navbar -->
		<div id="navbar-root"></div>

		<!-- Main -->
		<main class="flex-1 flex items-center justify-center px-4 py-12">
			<div class="w-full max-w-md">
				<div class="bg-neutral-900/60 ring-1 ring-neutral-800 rounded-2xl p-6 shadow-lg">
					<h1 class="text-xl font-semibold mb-6">Reset your password</h1>

					<!-- Email -->
					<div id="email-field" class="mb-4"></div>

					<div class="flex items-center justify-between mb-4">
						<!-- Spacer -->
						<div class="flex-1"></div>
						<!-- Submit -->
						<div id="submit-btn"></div>
					</div>

					<!-- Request preview (optional) -->
					<pre id="request-preview" class="mt-4 text-xs bg-neutral-950/60 ring-1 ring-neutral-800 rounded-lg p-3 overflow-x-auto hidden"></pre>
				</div>
			</div>
		</main>

		<div id="error-modal-root"></div>

		<script>
		const navbar = mountNavbar('#navbar-root', {
			brandHref: '/',
			brandName: 'Confilogi',
			brandAccent: 'IT Support',
			...LOGGED_OUT_NAVBAR_ARGS
		});

		const emailField = mountTextField('#email-field', {
			label: 'Email',
			type: 'email',
			placeholder: 'name@domain.com',
			value: '',
			onInput: ({ new_value }) => {
				// Optional: live validation hook
			}
		});

		const submitBtn = mountButton('#submit-btn', {
			label: 'Send reset link',
			variant: 'primary',
			size: 'md',
			type: 'submit',
			onClick: (e) => {
				e.preventDefault();
				assembleLoginRequest();
			}
		});

		// Central place to collect/preview the request (do not actually send)
		const requestPreviewEl = document.getElementById('request-preview');

		function assembleLoginRequest() {
			const email = emailField.getValue();

			// Build payload
			const payload = {
				email,
			};

			// Build request options (not executed)
			const url = '/api/login'; // adjust as needed
			const options = {
				method: 'POST',
				headers: {
					'Content-Type': 'application/json'
				},
				body: JSON.stringify(payload)
			};

			// Store in one place (global snapshot) and show a preview
			window.LATEST_LOGIN_REQUEST = {
				createdAt: new Date().toISOString(),
				url,
				options,
				payload
			};

			// Optional: Reveal a preview on screen
			if (requestPreviewEl) {
				requestPreviewEl.classList.remove('hidden');
				requestPreviewEl.textContent = JSON.stringify(window.LATEST_LOGIN_REQUEST, null, 2);
			}
		}
		</script>
	</body>
</html>
